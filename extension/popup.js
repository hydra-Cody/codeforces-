var e={$:(e,t)=>(t||document).querySelector(e),$$:(e,t)=>(t||document).querySelectorAll(e),on(e,t,n,o){e.addEventListener(t,n,o||{})},element(e,t,...n){let o;if("string"==typeof e){if(o=document.createElement(e),Object.assign(o,t),t)for(let e in t)e.startsWith("data-")||"for"==e?o.setAttribute(e,t[e]):(s=e).length>2&&"o"==s[0]&&"n"==s[1]&&s[2]>="A"&&s[2]<="Z"&&o.addEventListener(e.substr(2).toLowerCase(),t[e])}else"function"==typeof e&&(o=e(t));var s;for(let e of n)"string"==typeof e?o.appendChild(document.createTextNode(e)):e instanceof Array?o.append(...e):e&&o.appendChild(e);return o},fragment(...e){let t=document.createDocumentFragment();for(let n of e)if("string"==typeof n)t.appendChild(document.createTextNode(n));else if(n instanceof Array)for(let e of n)t.appendChild(e);else n&&t.appendChild(n);return t},isEditable(e){const t="INPUT"==e.tagName&&-1==["button","checkbox","color","file","hidden","image","radio","reset","submit"].indexOf(e.type),n="TEXTAREA"==e.tagName,o="SELECT"==e.tagName;return t||n||o||e.isContentEditable}};let t={};function n(e,n){t[e]||(t[e]=[]),t[e].push(n)}async function o(e,n){const o=(t[e]||[]).map(async e=>e(n));return Promise.all(o)}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}const a=function(){};function r(e,t,n,o){return{title:e,type:t,id:n,data:o}}let i=[r('"Show Tags" button',"toggle","showTags"),r("Sidebar Action Box","toggle","sidebarBox"),r("Default standings","select","defStandings",["Common","Friends"]),r("Custom Style","toggle","style"),r("Update standings every ___ seconds (0 to disable)","number","standingsItv"),r("Join div1 and div2 standings","toggle","standingsTwin"),r('Hide "on test X" in verdicts',"toggle","hideTestNumber"),r("Dark Theme","toggle","darkTheme")];function l(e,t){return{title:e,id:t}}let c=[l("Submit","submit"),l("Dark Theme","darkTheme"),l("Open Finder","finder"),l("Scroll to Content","scrollToContent"),l("Hide Test Number","hideTestNumber")];const u=({config:t,id:n,pushChange:o,pullChange:s})=>{let a=e.element("input",{id:n,checked:t[n],type:"checkbox",onChange:e=>o(n,e.target.checked)});return s(n,e=>a.checked=e),e.element(e.fragment,null,a,e.element("span",null))},d=({config:t,id:n,pushChange:o})=>e.element("input",{id:n,value:t[n]||0,type:"number",onInput:e=>o(n,+e.target.value)}),g=({config:t,id:n,data:o,pushChange:s})=>e.element("select",{id:n,onChange:e=>s(n,e.target.value)},o.map(o=>e.element("option",{value:o,selected:o==t[n]},o))),h=({config:t,id:n,pushChange:o})=>e.element("input",{id:n,value:t[n],type:"text",onChange:e=>o(n,e.target.value)});function m({title:t,type:n,id:o,data:a,config:r,pushChange:i,pullChange:l}){let c={config:r,id:o,pushChange:i,pullChange:l};let m={toggle:()=>e.element(u,c),number:()=>e.element(d,c),select:()=>e.element(g,s({},c,{data:a})),text:()=>e.element(h,c)}[n]();return e.element("label",{className:n,for:o},t,m)}function p({title:t,id:n,shortcuts:o,pushChange:s}){const a=function(e,t){let n;return function(...o){clearTimeout(n),n=setTimeout(()=>{n=void 0,e(...o)},t)}}(s,250);return e.element("label",{className:"shortcut",for:"sc-"+n},t,e.element("input",{id:"sc-"+n,value:o[n],type:"text",onKeyDown:function(e){e.preventDefault();let t=function(e){let t="";var n;return e.metaKey&&(t+="Meta+"),e.ctrlKey&&(t+="Ctrl+"),e.altKey&&(t+="Alt+"),e.shiftKey&&(t+="Shift+"),t+=" "==e.key?"Space":(n=e.key)[0].toUpperCase()+n.slice(1).toLowerCase(),t}(e);"Escape"!=t&&(e.target.value=t,a(n,t))}}))}function f({config:t,pushChange:n=a,pullChange:o=a}){return i.map(a=>e.element(m,s({},a,{config:t,pushChange:n,pullChange:o})))}function C({shortcuts:t,pushChange:n=a}){return c.map(o=>e.element(p,s({},o,{shortcuts:t,pushChange:n})))}const y=e=>(...t)=>"complete"==document.readyState?Promise.resolve(e(...t)):new Promise(n=>document.addEventListener("DOMContentLoaded",()=>n(e(...t)),{once:!0}));!function(e){let t,n=!1}(y((function(){const t=e.$(".lang-chooser").children[1].children[0].innerText.trim();return"Enter"==t?"tourist":t})));window;const b=a;v=1;var v;const T={showTags:!0,style:!0,darkTheme:!1,standingsItv:0,standingsTwin:!1,defStandings:"common",hideTestNumber:!1,sidebarBox:!0,tutorialSpoilers:!1,mashupSpoilers:!1,shortcuts:{darkTheme:"Ctrl+I",finder:"Ctrl+Space",submit:"Ctrl+S",scrollToContent:"Ctrl+Alt+C",hideTestNumber:"Ctrl+Shift+H"}};let w;function S(e,t){function n(n){browser.tabs.sendMessage(n.id,{type:"config change",to:"is",id:e,value:t})}browser.tabs.query({url:"*://codeforces.com/*"}).then(e=>e.forEach(n))}function k(e,t){console.log(`#${e} changed to ${t}. Notifying clients.`),w[e]=t,o(e,t),S(e,t),browser.storage.sync.set({cfpp:w})}function N(e,t){console.log(`shortcut #${e} changed to ${t}. Notifying clients.`),w.shortcuts[e]=t,S("shortcuts",w.shortcuts),browser.storage.sync.set({cfpp:w})}n("darkTheme",e=>{document.body.classList.toggle("dark",e)}),async function(){w=await browser.storage.sync.get(["cfpp"]),w=w.cfpp,w=Object.assign({},T,w),w.darkTheme&&document.body.classList.add("dark"),document.body.appendChild(e.element("div",{id:"ui"},e.element(f,{config:w,pushChange:k,pullChange:n}),e.element("span",{className:"hr"}),e.element(C,{shortcuts:w.shortcuts,pushChange:N})))}();
